
<!DOCTYPE html>

<html class="no-js" lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width,initial-scale=1" name="viewport"/>
<link href="../../../images/favicon.ico" rel="icon"/>
<meta content="mkdocs-1.2.2, mkdocs-material-7.2.2" name="generator"/>
<title>Structure - ElectionGuard</title>
<link href="../../../assets/stylesheets/main.1118c9be.min.css" rel="stylesheet"/>
<link href="../../../assets/stylesheets/palette.ba0d045b.min.css" rel="stylesheet"/>
<link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css?family=Segoe+UI:300,400,400i,700%7C&amp;display=fallback" rel="stylesheet"/>
<style>:root{--md-text-font-family:"Segoe UI";--md-code-font-family:""}</style>
<link href="../../../stylesheets/extra.css" rel="stylesheet"/>
<meta content="website" property="og:type">
<meta content="ElectionGuard - Structure" property="og:title">
<meta content="None" property="og:description">
<meta content="None" property="og:url"/>
<meta content="https://microsoft.github.io/electionguard/assets/images/electionguard-preview.png" property="og:image"/>
<meta content="image/png" property="og:image:type"/>
<meta content="1200" property="og:image:width"/>
<meta content="630" property="og:image:height"/>
<meta content="summary_large_image" name="twitter:card"/>
<meta content="@microsoft" name="twitter:site"/>
<meta content="ElectionGuard - Structure" name="twitter:title"/>
<meta content="None" name="twitter:description"/>
<meta content="https://microsoft.github.io/electionguard/assets/images/electionguard-preview.png" name="twitter:image"/>
</meta></meta></meta></head>
<body data-md-color-accent="indigo" data-md-color-primary="" data-md-color-scheme="default" dir="ltr">
<script>function __prefix(e){return new URL("../../..",location).pathname+"."+e}function __get(e,t=localStorage){return JSON.parse(t.getItem(__prefix(e)))}</script>
<input autocomplete="off" class="md-toggle" data-md-toggle="drawer" id="__drawer" type="checkbox"/>
<input autocomplete="off" class="md-toggle" data-md-toggle="search" id="__search" type="checkbox"/>
<label class="md-overlay" for="__drawer"></label>
<div data-md-component="skip">
<a class="md-skip" href="#electionguard-structure">
          Skip to content
        </a>
</div>
<div data-md-component="announce">
</div>
<header class="md-header" data-md-component="header">
<nav aria-label="Header" class="md-header__inner md-grid">
<a aria-label="ElectionGuard" class="md-header__button md-logo" data-md-component="logo" href="../../.." title="ElectionGuard">
<img alt="logo" src="../../../images/electionguard-logo.png"/>
</a>
<label class="md-header__button md-icon" for="__drawer">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"></path></svg>
</label>
<div class="md-header__title" data-md-component="header-title">
<div class="md-header__ellipsis">
<div class="md-header__topic">
<span class="md-ellipsis">
            ElectionGuard
          </span>
</div>
<div class="md-header__topic" data-md-component="header-topic">
<span class="md-ellipsis">
            
              Structure
            
          </span>
</div>
</div>
</div>
<label class="md-header__button md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"></path></svg>
</label>
<div class="md-search" data-md-component="search" role="dialog">
<label class="md-search__overlay" for="__search"></label>
<div class="md-search__inner" role="search">
<form class="md-search__form" name="search">
<input aria-label="Search" autocapitalize="off" autocomplete="off" autocorrect="off" class="md-search__input" data-md-component="search-query" name="query" placeholder="Search" required="" spellcheck="false" type="text"/>
<label class="md-search__icon md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"></path></svg>
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"></path></svg>
</label>
<nav aria-label="Search" class="md-search__options">
<button aria-label="Clear" class="md-search__icon md-icon" tabindex="-1" type="reset">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"></path></svg>
</button>
</nav>
</form>
<div class="md-search__output">
<div class="md-search__scrollwrap" data-md-scrollfix="">
<div class="md-search-result" data-md-component="search-result">
<div class="md-search-result__meta">
            Initializing search
          </div>
<ol class="md-search-result__list"></ol>
</div>
</div>
</div>
</div>
</div>
<div class="md-header__source">
<a class="md-source" data-md-component="source" href="https://github.com/microsoft/electionguard/" title="Go to repository">
<div class="md-source__icon md-icon">
<svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"></path></svg>
</div>
<div class="md-source__repository">
    GitHub
  </div>
</a>
</div>
</nav>
</header>
<div class="md-container" data-md-component="container">
<nav aria-label="Tabs" class="md-tabs" data-md-component="tabs">
<div class="md-tabs__inner md-grid">
<ul class="md-tabs__list">
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../..">
        Documentation
      </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link md-tabs__link--active" href="../../1.0.0/1_Overview/">
        Specification
      </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../../community/">
      Community
    </a>
</li>
</ul>
</div>
</nav>
<main class="md-main" data-md-component="main">
<div class="md-main__inner md-grid">
<div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Navigation" class="md-nav md-nav--primary md-nav--lifted" data-md-level="0">
<label class="md-nav__title" for="__drawer">
<a aria-label="ElectionGuard" class="md-nav__button md-logo" data-md-component="logo" href="../../.." title="ElectionGuard">
<img alt="logo" src="../../../images/electionguard-logo.png"/>
</a>
    ElectionGuard
  </label>
<div class="md-nav__source">
<a class="md-source" data-md-component="source" href="https://github.com/microsoft/electionguard/" title="Go to repository">
<div class="md-source__icon md-icon">
<svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"></path></svg>
</div>
<div class="md-source__repository">
    GitHub
  </div>
</a>
</div>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle" data-md-state="indeterminate" data-md-toggle="__nav_1" id="__nav_1" type="checkbox"/>
<label class="md-nav__link" for="__nav_1">
        Documentation
        <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-label="Documentation" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_1">
<span class="md-nav__icon md-icon"></span>
          Documentation
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle" data-md-state="indeterminate" data-md-toggle="__nav_1_1" id="__nav_1_1" type="checkbox"/>
<label class="md-nav__link" for="__nav_1_1">
        Overview
        <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-label="Overview" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_1_1">
<span class="md-nav__icon md-icon"></span>
          Overview
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../..">
        About
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../overview/Roadmap/">
        Roadmap
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../overview/Glossary/">
        Glossary
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../getting_started/">
        Getting Started
      </a>
</li>
<li class="md-nav__item md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle" data-md-state="indeterminate" data-md-toggle="__nav_1_3" id="__nav_1_3" type="checkbox"/>
<label class="md-nav__link" for="__nav_1_3">
        Concepts
        <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-label="Concepts" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_1_3">
<span class="md-nav__icon md-icon"></span>
          Concepts
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../concepts/Election_Manifest/">
        Manifest
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../concepts/Ballot_Encryption/">
        Ballot Encryption
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../concepts/Verifiable_Election/">
        Verifiable Election
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../concepts/Setting_up_an_election/">
        Setting up an Election
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../concepts/Ballot_Rescans_and_Recounts/">
        Rescanning Ballots and Recounts
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle" data-md-state="indeterminate" data-md-toggle="__nav_1_4" id="__nav_1_4" type="checkbox"/>
<label class="md-nav__link" for="__nav_1_4">
        Use Cases
        <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-label="Use Cases" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_1_4">
<span class="md-nav__icon md-icon"></span>
          Use Cases
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../use_cases/Precinct_Scan/">
        Precinct Scan
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle" data-md-state="indeterminate" data-md-toggle="__nav_1_5" id="__nav_1_5" type="checkbox"/>
<label class="md-nav__link" for="__nav_1_5">
        Develop
        <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-label="Develop" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_1_5">
<span class="md-nav__icon md-icon"></span>
          Develop
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../develop/Getting_Started/">
        Getting Started
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../develop/Architecture/">
        Architecture
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../develop/Data/">
        Data
      </a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--active md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" id="__nav_2" type="checkbox"/>
<label class="md-nav__link" for="__nav_2">
        Specification
        <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-label="Specification" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_2">
<span class="md-nav__icon md-icon"></span>
          Specification
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../1.0.0/1_Overview/">
        Overview
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../1.0.0/2_Structure/">
        Structure
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../1.0.0/3_Baseline_parameters/">
        Baseline Parameters
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../1.0.0/4_Key_generation/">
        Key Generation
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../1.0.0/5_Ballot_encryption/">
        Ballot Encryption
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../1.0.0/6_Ballot_aggregation/">
        Ballot Aggregation
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../1.0.0/7_Verifiable_decryption/">
        Verifiable Decryption
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../1.0.0/8_The_election_record/">
        The Election Record
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../1.0.0/9_Verifier_construction/">
        Verifier Construction
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../1.0.0/10_Applicability/">
        Applicability to E2E Verifiability and RLA
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../1.0.0/11_Acknowledgements/">
        Acknowledgements
      </a>
</li>
<li class="md-nav__item md-nav__item--active md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_12" id="__nav_2_12" type="checkbox"/>
<label class="md-nav__link" for="__nav_2_12">
        Other Versions
        <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-label="Other Versions" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_2_12">
<span class="md-nav__icon md-icon"></span>
          Other Versions
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item md-nav__item--active md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_12_1" id="__nav_2_12_1" type="checkbox"/>
<label class="md-nav__link" for="__nav_2_12_1">
        v0.95.0
        <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-label="v0.95.0" class="md-nav" data-md-level="3">
<label class="md-nav__title" for="__nav_2_12_1">
<span class="md-nav__icon md-icon"></span>
          v0.95.0
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../1_Overview/">
        Overview
      </a>
</li>
<li class="md-nav__item md-nav__item--active">
<input class="md-nav__toggle md-toggle" data-md-toggle="toc" id="__toc" type="checkbox"/>
<label class="md-nav__link md-nav__link--active" for="__toc">
          Structure
          <span class="md-nav__icon md-icon"></span>
</label>
<a class="md-nav__link md-nav__link--active" href="./">
        Structure
      </a>
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#overview">
    Overview
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#notation">
    Notation
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#encryption-of-votes">
    Encryption of Votes
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#homomorphic-properties">
    Homomorphic Properties
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#non-interactive-zero-knowledge-nizk-proofs">
    Non-Interactive Zero-Knowledge (NIZK) Proofs
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#threshold-encryption">
    Threshold Encryption
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../3_Baseline_parameters/">
        Baseline Parameters
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../4_Key_generation/">
        Key Generation
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../5_Ballot_encryption/">
        Ballot Encryption
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../6_Ballot_aggregation/">
        Ballot Aggregation
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../7_Verifiable_decryption/">
        Verifiable Decryption
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../8_The_election_record/">
        The Election Record
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../9_Verifier_construction/">
        Verifier Construction
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../10_Applicability/">
        Applicability to E2E Verifiability and RLA
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../11_Acknowledgements/">
        Acknowledgements
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="https://github.com/microsoft/electionguard/releases/tag/v0.85.0">
        v0.85.0
      </a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../community/">
        Community
      </a>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#overview">
    Overview
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#notation">
    Notation
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#encryption-of-votes">
    Encryption of Votes
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#homomorphic-properties">
    Homomorphic Properties
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#non-interactive-zero-knowledge-nizk-proofs">
    Non-Interactive Zero-Knowledge (NIZK) Proofs
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#threshold-encryption">
    Threshold Encryption
  </a>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-content" data-md-component="content">
<article class="md-content__inner md-typeset">
<a class="md-content__button md-icon" href="https://github.com/microsoft/electionguard/edit/master/docs/spec/0.95.0/2_Structure.md" title="Edit this page">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"></path></svg>
</a>
<h1 id="electionguard-structure">ElectionGuard Structure</h1>
<h2 id="overview">Overview</h2>
<p>In an election, a set of guardians is enlisted to serve as trustees who manage cryptographic keys. The members of a canvassing board can serve as guardians. Prior to the commencement of voting or auditing, the guardians work together to form a public encryption key that will be used to encrypt individual ballots.</p>
<p>After the conclusion of voting or auditing, a quorum of guardians is necessary to produce the artifacts required to enable public verification of the tally.</p>
<p>ElectionGuard has four principal components:</p>
<ol>
<li>Baseline Parameters – These are general parameters that are standard in every election. An alternate means for generating parameters is described, but the burden of verifying an election is increased if alternate parameters are used because a verifier would need to verify the proper construction of any alternate parameters.</li>
<li>Key Generation – Prior to each individual election, guardians must generate individual public-private key pairs and exchange shares of private keys to enable completion of an election even if some guardians become unavailable. Although it is preferred to generate new keys for each election, it is permissible to use the same keys for multiple elections so long as the set of guardians remains the same. A complete new set of keys must be generated if even a single guardian is replaced.</li>
<li>Ballot Encryption – While encrypting the contents of a ballot is a relatively simple operation, most of the work of ElectionGuard is the process of creating externally verifiable artifacts to prove that each encrypted ballot is well-formed (i.e., its decryption is a legitimate ballot without overvotes or improper values).</li>
<li>Verifiable Decryption – At the conclusion of each election, guardians use their private keys to produce election tallies together with verifiable artifacts that prove that the tallies are correct.</li>
</ol>
<h2 id="notation">Notation</h2>
<p>In the remainder of this specification, the following notation will be used:</p>
<ul>
<li><span class="arithmatex">\(\\Z = \{\dots , −3, −2, −1, 0, 1, 2, 3, \dots\}\)</span> is the set of integers.</li>
<li><span class="arithmatex">\(\\ℤ_n = \{0, 1, 2, \dots , n − 1\}\)</span> is the additive group of the integers modulo <span class="arithmatex">\(n\)</span>.</li>
<li><span class="arithmatex">\(\\Z_n^*\)</span> is the multiplicative subgroup of <span class="arithmatex">\(\\Z_n\)</span>. When <span class="arithmatex">\(p\)</span> is a prime, <span class="arithmatex">\(\\Z_p^* = \{1,2,3, \dots, p-1\}\)</span>.</li>
<li><span class="arithmatex">\(\\Z_p^r\)</span> is the set of <span class="arithmatex">\(r^{th}\)</span>-residues in <span class="arithmatex">\(\\Z_p^*\)</span>. Formally, <span class="arithmatex">\(Z_p^r = \{ y \in \\Z_p^*\)</span> for which <span class="arithmatex">\(\exists x \in \\Z_p^*\)</span> such that <span class="arithmatex">\(y=x^r\bmod p \}\)</span>. When <span class="arithmatex">\(p\)</span> is a prime for which <span class="arithmatex">\(p-1=qr\)</span> with <span class="arithmatex">\(q\)</span> a prime that is not a divisor of integer <span class="arithmatex">\(r\)</span>, then <span class="arithmatex">\(\\Z_p^r\)</span> is an order <span class="arithmatex">\(q\)</span> cyclic subgroup of <span class="arithmatex">\(\\Z_p^*\)</span> and for each <span class="arithmatex">\(y\in \\Z_p^*\)</span>, <span class="arithmatex">\(y\in \\Z_p^r\)</span> if and only if <span class="arithmatex">\(y^q \bmod p = 1\)</span>.</li>
<li><span class="arithmatex">\(x\equiv_n y\)</span> is the predicate that is true if and only if <span class="arithmatex">\(x \bmod n = y \bmod n\)</span>.</li>
<li>The function <span class="arithmatex">\(H()\)</span> shall be use to designate the SHA-256 hash function (as defined in NIST PUB FIPS 180-4<sup id="fnref:3"><a class="footnote-ref" href="#fn:3">1</a></sup>).</li>
<li>In general, the variable pairs <span class="arithmatex">\((\alpha, \beta)\)</span>, <span class="arithmatex">\((a, b)\)</span>, and <span class="arithmatex">\((A,B)\)</span> will be used to denote encryptions. Specifically, <span class="arithmatex">\((\alpha,\beta)\)</span> will be used to designate encryptions of votes (<em>always</em> an encryption of a zero or one), <span class="arithmatex">\((A,B)\)</span> will be used to denote aggregations of encryptions (which may be encryptions of larger values), and <span class="arithmatex">\((a,b)\)</span> will be used to denote encryption commitments used to prove properties of other encryptions.</li>
</ul>
<h2 id="encryption-of-votes">Encryption of Votes</h2>
<p>Encryption of votes in ElectionGuard is performed using an exponential form of the ElGamal cryptosystem <sup id="fnref:4"><a class="footnote-ref" href="#fn:4">2</a></sup>. Primes <span class="arithmatex">\(p\)</span> and <span class="arithmatex">\(q\)</span> are publicly fixed such that <span class="arithmatex">\(q\)</span> is not a divisor of <span class="arithmatex">\(r=\frac{p-1}{q}\)</span> . A generator <span class="arithmatex">\(g\)</span> of the order <span class="arithmatex">\(q\)</span> subgroup <span class="arithmatex">\(Z_r^p\)</span> is also fixed. (Any <span class="arithmatex">\(g=x^r\bmod p\)</span> for which <span class="arithmatex">\(x \in Z_p^*\)</span>
suffices so long as <span class="arithmatex">\(g\ne 1\)</span>).</p>
<p>A public-private key pair can be chosen by selecting a random <span class="arithmatex">\(s \in Z_q\)</span> as a private key and publishing <span class="arithmatex">\(K = g^s \bmod p\)</span> as a public key.<sup id="fnref:5"><a class="footnote-ref" href="#fn:5">3</a></sup></p>
<p>A message <span class="arithmatex">\(M \in Z_p^r\)</span> is then encrypted by selecting a random nonce <span class="arithmatex">\(R \in Z_q\)</span> and forming the pair <span class="arithmatex">\((\alpha,\beta) = (g^R \bmod p, g^M \dot K^R \bmod p)\)</span>. An encryption <span class="arithmatex">\((\alpha,\beta)\)</span> can be decrypted by the holder of the secret <span class="arithmatex">\(s\)</span> as</p>
<div class="arithmatex">\[
\frac{\beta}{\alpha^s}\bmod p= \frac{g^M \cdot K^R}{(g^R)^s}\bmod p = \frac{g^M \cdot (g^s)^R}{(g^R)^s} \bmod p = \frac{g^M \cdot g^{Rs}}{g^{Rs}} \bmod p = g^M \bmod p
\]</div>
<p>The value of <span class="arithmatex">\(M\)</span> can be computed from <span class="arithmatex">\(g^M \bmod p\)</span> as long as the message <span class="arithmatex">\(M\)</span> is limited to a small, known set of options.</p>
<p>Only two possible messages are encrypted in this way by ElectionGuard:</p>
<ul>
<li>an encryption of one is used to indicate that an option is selected, and</li>
<li>an encryption of zero is used to indicate that an option is not selected.</li>
</ul>
<h2 id="homomorphic-properties">Homomorphic Properties</h2>
<p>A fundamental quality of the exponential form of ElGamal described earlier is its additively homomorphic property. If two messages <span class="arithmatex">\(M_1\)</span> and <span class="arithmatex">\(M_2\)</span> are respectively encrypted as <span class="arithmatex">\((A_1,B_1) = (g^{R_1} \bmod p,g^{M_1}\cdot K^{R_1} \bmod p)\)</span> and
<span class="arithmatex">\((A_2,B_2) = (g^{R_2} \bmod p,g^{M_2}\cdot K^{R_2} \bmod p)\)</span>
then the component-wise product
<span class="arithmatex">\((A,B) = (A_1 A_2 \bmod p, B_1 B_2 \bmod p = (g^{R_1 + R_2} \bmod p, g^{M_1 + M_2} \cdot K^{R_1 + R_2} \bmod p)\)</span> is an encryption of the sum <span class="arithmatex">\(M_1 + M_2\)</span>.</p>
<p>(There is an implicit assumption here that <span class="arithmatex">\(M_1 + M_2 &lt; q\)</span> which is easily satisfied when <span class="arithmatex">\(M_1\)</span> and <span class="arithmatex">\(M_2\)</span> are both small. If <span class="arithmatex">\((R_1 + R_2) \ge q, (R_1 + R_2) \bmod q\)</span> may be substituted without changing the equation since <span class="arithmatex">\(g^q \bmod p =1\)</span>.)</p>
<p>This additively homomorphic property is used in two important ways in ElectionGuard. First, all of the encryptions of a single option across ballots can be multiplied to form an encryption of the sum of the individual values. Since the individual values are one on ballots that select that option and zero otherwise, the sum is the tally of votes for that option and the product of the individual encryptions is an encryption of the tally.</p>
<p>The other use is to sum all of the selections made in a single contest on a single ballot. After demonstrating that each option is an encryption of either zero or one, the product of the encryptions indicates the number of options that are encryptions of one, and this can be used to show that no more ones than permitted are among the encrypted options – i.e., that no more options were selected than permitted.</p>
<p>However, as will be described below, it is possible for a holder of a nonce 𝑅 to prove to a third party that a pair (𝛼, 𝛽) is an encryption of 𝑀 without revealing the nonce 𝑅 and without access to the secret 𝑠.</p>
<h2 id="non-interactive-zero-knowledge-nizk-proofs">Non-Interactive Zero-Knowledge (NIZK) Proofs</h2>
<p>ElectionGuard provides numerous proofs about encryption keys, encrypted ballots, and election tallies using the following four techniques.</p>
<ol>
<li>A Schnorr proof<sup id="fnref:7"><a class="footnote-ref" href="#fn:7">5</a></sup> allows the holder of an ElGamal secret key 𝑠 to interactively prove possession of <span class="arithmatex">\(s\)</span> without revealing <span class="arithmatex">\(s\)</span>.</li>
<li>A Chaum-Pedersen proof<sup id="fnref:8"><a class="footnote-ref" href="#fn:8">6</a></sup> allows an ElGamal encryption to be interactively proven to decrypt to a particular value without revealing the nonce used for encryption or the secret decryption key <span class="arithmatex">\(s\)</span>. (This proof can be constructed with access to either the nonce used for encryption or the secret decryption key.)</li>
<li>The Cramer-Damgård-Schoenmakers technique<sup id="fnref:9"><a class="footnote-ref" href="#fn:9">7</a></sup> enables a disjunction to be interactively proven without revealing which disjunct is true.</li>
<li>The Fiat-Shamir heuristic<sup id="fnref:10"><a class="footnote-ref" href="#fn:10">8</a></sup> allows interactive proofs to be converted into non- interactive proofs.
Using a combination of the above techniques, it is possible for ElectionGuard to demonstrate that keys are properly chosen, that ballots are properly formed, and that decryptions match claimed values.</li>
</ol>
<h2 id="threshold-encryption">Threshold Encryption</h2>
<p>Threshold ElGamal encryption is used for encryption of ballots and other data. This form of encryption makes it very easy to combine individual guardian public keys into a single public key. It also offers a homomorphic property that allows individual encrypted votes to be combined to form encrypted tallies.</p>
<p>The guardians of an election will each generate a public-private key pair. The public keys will then be combined (as described in the following section) into a single election public key which is used to encrypt all selections made by voters in the election.</p>
<p>Ideally, at the conclusion of the election, each guardian will use its private key to form a verifiable partial decryption of each tally.  These partial decryptions will then be combined to form full verifiable decryptions of the election tallies.</p>
<p>To accommodate the possibility that one or more of the guardians will not be available at the conclusion of the election to form their partial decryptions, the guardians will cryptographically share  their private keys amongst each other during key generation in a manner to be detailed in the next section.  A pre-determined threshold quorum value <span class="arithmatex">\((k)\)</span> out of the <span class="arithmatex">\((n)\)</span> guardians will be necessary to produce a full decryption.</p>
<div class="footnote">
<hr/>
<ol>
<li id="fn:3">
<p>NIST (2015) Secure Hash Standard (SHS). In: FIPS 180-4. <a href="https://csrc.nist.gov/publications/detail/fips/180/4/final">https://csrc.nist.gov/publications/detail/fips/180/4/final</a> <a class="footnote-backref" href="#fnref:3" title="Jump back to footnote 1 in the text">↩</a></p>
</li>
<li id="fn:4">
<p>ElGamal T. (1985) A Public Key Cryptosystem and a Signature Scheme Based on Discrete Logarithms. In:  Blakley G.R., Chaum D. (eds) Advances in Cryptology. CRYPTO 1984. Lecture Notes in Computer Science, vol 196
<a href="https://link.springer.com/content/pdf/10.1007/3-540-39568-7_2.pdf">https://link.springer.com/content/pdf/10.1007/3-540-39568-7_2.pdf</a> <a class="footnote-backref" href="#fnref:4" title="Jump back to footnote 2 in the text">↩</a></p>
</li>
<li id="fn:5">
<p>As will be seen below, the actual public key used to encrypt votes will be a combination of separately-generated public keys. So no entity will ever be in possession of a private key that can be used to decrypt votes. <a class="footnote-backref" href="#fnref:5" title="Jump back to footnote 3 in the text">↩</a></p>
</li>
<li id="fn:6">
<p>The simplest way to compute <span class="arithmatex">\(M\)</span> from <span class="arithmatex">\(g^M \bmod p\)</span> is an exhaustive search through possible values of <span class="arithmatex">\(M\)</span>. Alternatively, a table of pairing each possible value of <span class="arithmatex">\(g^M \bmod p\)</span> can be pre-computed. A final option which can accommodate a larger space of possible values for <span class="arithmatex">\(M\)</span> is to use Shanks’s <em>baby-step giant-step method</em> as described in the 1971 paper “Class Number, a Theory of Factorization and Genera,” Proceedings of Symposium in Pure Mathematics, Vol. 20, American Mathematical Society, Providence, 1971, pp. 415-440. <a class="footnote-backref" href="#fnref:6" title="Jump back to footnote 4 in the text">↩</a></p>
</li>
<li id="fn:7">
<p>Schnorr C.P. (1990) Efficient Identification and Signatures for Smart Cards. In: Brassard G. (eds) Advances in Cryptology — CRYPTO’ 89 Proceedings. CRYPTO 1989. Lecture Notes in Computer Science, vol 435. Springer, New York, NY. <a href="https://link.springer.com/content/pdf/10.1007/0-387-34805-0_22.pdf">https://link.springer.com/content/pdf/10.1007/0-387-34805-0_22.pdf</a> <a class="footnote-backref" href="#fnref:7" title="Jump back to footnote 5 in the text">↩</a></p>
</li>
<li id="fn:8">
<p>Chaum D., Pedersen T.P. (1993) Wallet Databases with Observers. In: Brickell E.F. (eds) Advances in
Cryptology — CRYPTO' 92. Lecture Notes in Computer Science, volume 740. Springer, Berlin, Heidelberg. <a href="https://link.springer.com/content/pdf/10.1007/3-540-48071-4_7.pdf">https://link.springer.com/content/pdf/10.1007/3-540-48071-4_7.pdf</a> <a class="footnote-backref" href="#fnref:8" title="Jump back to footnote 6 in the text">↩</a></p>
</li>
<li id="fn:9">
<p>Fiat A., Shamir A. (1987) How To Prove Yourself: Practical Solutions to Identification and Signature Problems. In: Odlyzko A.M. (eds) Advances in Cryptology — CRYPTO’ 86. CRYPTO 1986. Lecture Notes in Computer Science, vol 263. Springer, Berlin, Heidelberg. <a href="https://link.springer.com/content/pdf/10.1007%2F3-540-47721-7_12.pdf">https://link.springer.com/content/pdf/10.1007%2F3-540-47721-7_12.pdf</a> <a class="footnote-backref" href="#fnref:9" title="Jump back to footnote 7 in the text">↩</a></p>
</li>
<li id="fn:10">
<p>Fiat A., Shamir A. (1987) How To Prove Yourself: Practical Solutions to Identification and Signature Problems. In: Odlyzko A.M. (eds) Advances in Cryptology — CRYPTO’ 86. CRYPTO 1986. Lecture Notes in Computer Science, vol 263. Springer, Berlin, Heidelberg. <a href="https://link.springer.com/content/pdf/10.1007%2F3-540-47721-7_12.pdf">https://link.springer.com/content/pdf/10.1007%2F3-540-47721-7_12.pdf</a> <a class="footnote-backref" href="#fnref:10" title="Jump back to footnote 8 in the text">↩</a></p>
</li>
<li id="fn:11">
<p>Shamir A.  How to Share a Secret.  (1979) Communications of the ACM <a class="footnote-backref" href="#fnref:11" title="Jump back to footnote 9 in the text">↩</a></p>
</li>
</ol>
</div>
</article>
</div>
</div>
</main>
<footer class="md-footer">
<div class="md-footer-nav">
<nav aria-label="Footer" class="md-footer-nav__inner md-grid">
<a class="md-footer-nav__link md-footer-nav__link--prev" href="../1_Overview/" rel="prev" title="Overview">
<div class="md-footer-nav__button md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"></path></svg>
</div>
<div class="md-footer-nav__title">
<div class="md-ellipsis">
<span class="md-footer-nav__direction">
                  Previous
                </span>
                Overview
              </div>
</div>
</a>
<a class="md-footer-nav__link md-footer-nav__link--next" href="../3_Baseline_parameters/" rel="next" title="Baseline Parameters">
<div class="md-footer-nav__title">
<div class="md-ellipsis">
<span class="md-footer-nav__direction">
                  Next
                </span>
                Baseline Parameters
              </div>
</div>
<div class="md-footer-nav__button md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"></path></svg>
</div>
</a>
</nav>
</div>
<div class="md-footer-meta md-typeset">
<div class="md-footer-meta__inner md-grid">
<div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" rel="noopener" target="_blank">
          Material for MkDocs
        </a> and <a href="https://icons8.com/" rel="noopener" target="_blank">
          Icons8
        </a>
</div>
<div class="md-footer-copyright" style="display: flex; align-items:center;">
<ul style="list-style: none;">
<li><a href="https://privacy.microsoft.com">Privacy</a></li>
<li><a href="">Terms of Service</a></li>
</ul>
</div>
</div>
</div>
</footer>
</div>
<div class="md-dialog" data-md-component="dialog">
<div class="md-dialog__inner md-typeset"></div>
</div>
<script id="__config" type="application/json">{"base": "../../..", "features": ["navigation.expand", "navigation.instant", "navigation.tabs"], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "../../../assets/javascripts/workers/search.709b4209.min.js", "version": null}</script>
<script src="../../../assets/javascripts/bundle.2b46852b.min.js"></script>
<script src="../../../javascripts/config.js"></script>
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
</body>
</html>