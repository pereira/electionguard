
<!DOCTYPE html>

<html class="no-js" lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width,initial-scale=1" name="viewport"/>
<link href="../../../images/favicon.ico" rel="icon"/>
<meta content="mkdocs-1.2.2, mkdocs-material-7.2.2" name="generator"/>
<title>Ballot Encryption - ElectionGuard</title>
<link href="../../../assets/stylesheets/main.1118c9be.min.css" rel="stylesheet"/>
<link href="../../../assets/stylesheets/palette.ba0d045b.min.css" rel="stylesheet"/>
<link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css?family=Segoe+UI:300,400,400i,700%7C&amp;display=fallback" rel="stylesheet"/>
<style>:root{--md-text-font-family:"Segoe UI";--md-code-font-family:""}</style>
<link href="../../../stylesheets/extra.css" rel="stylesheet"/>
<meta content="website" property="og:type">
<meta content="ElectionGuard - Ballot Encryption" property="og:title">
<meta content="None" property="og:description">
<meta content="None" property="og:url"/>
<meta content="https://microsoft.github.io/electionguard/assets/images/electionguard-preview.png" property="og:image"/>
<meta content="image/png" property="og:image:type"/>
<meta content="1200" property="og:image:width"/>
<meta content="630" property="og:image:height"/>
<meta content="summary_large_image" name="twitter:card"/>
<meta content="@microsoft" name="twitter:site"/>
<meta content="ElectionGuard - Ballot Encryption" name="twitter:title"/>
<meta content="None" name="twitter:description"/>
<meta content="https://microsoft.github.io/electionguard/assets/images/electionguard-preview.png" name="twitter:image"/>
</meta></meta></meta></head>
<body data-md-color-accent="indigo" data-md-color-primary="" data-md-color-scheme="default" dir="ltr">
<script>function __prefix(e){return new URL("../../..",location).pathname+"."+e}function __get(e,t=localStorage){return JSON.parse(t.getItem(__prefix(e)))}</script>
<input autocomplete="off" class="md-toggle" data-md-toggle="drawer" id="__drawer" type="checkbox"/>
<input autocomplete="off" class="md-toggle" data-md-toggle="search" id="__search" type="checkbox"/>
<label class="md-overlay" for="__drawer"></label>
<div data-md-component="skip">
<a class="md-skip" href="#ballot-encryption">
          Skip to content
        </a>
</div>
<div data-md-component="announce">
</div>
<header class="md-header" data-md-component="header">
<nav aria-label="Header" class="md-header__inner md-grid">
<a aria-label="ElectionGuard" class="md-header__button md-logo" data-md-component="logo" href="../../.." title="ElectionGuard">
<img alt="logo" src="../../../images/electionguard-logo.png"/>
</a>
<label class="md-header__button md-icon" for="__drawer">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"></path></svg>
</label>
<div class="md-header__title" data-md-component="header-title">
<div class="md-header__ellipsis">
<div class="md-header__topic">
<span class="md-ellipsis">
            ElectionGuard
          </span>
</div>
<div class="md-header__topic" data-md-component="header-topic">
<span class="md-ellipsis">
            
              Ballot Encryption
            
          </span>
</div>
</div>
</div>
<label class="md-header__button md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"></path></svg>
</label>
<div class="md-search" data-md-component="search" role="dialog">
<label class="md-search__overlay" for="__search"></label>
<div class="md-search__inner" role="search">
<form class="md-search__form" name="search">
<input aria-label="Search" autocapitalize="off" autocomplete="off" autocorrect="off" class="md-search__input" data-md-component="search-query" name="query" placeholder="Search" required="" spellcheck="false" type="text"/>
<label class="md-search__icon md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"></path></svg>
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"></path></svg>
</label>
<nav aria-label="Search" class="md-search__options">
<button aria-label="Clear" class="md-search__icon md-icon" tabindex="-1" type="reset">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"></path></svg>
</button>
</nav>
</form>
<div class="md-search__output">
<div class="md-search__scrollwrap" data-md-scrollfix="">
<div class="md-search-result" data-md-component="search-result">
<div class="md-search-result__meta">
            Initializing search
          </div>
<ol class="md-search-result__list"></ol>
</div>
</div>
</div>
</div>
</div>
<div class="md-header__source">
<a class="md-source" data-md-component="source" href="https://github.com/microsoft/electionguard/" title="Go to repository">
<div class="md-source__icon md-icon">
<svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"></path></svg>
</div>
<div class="md-source__repository">
    GitHub
  </div>
</a>
</div>
</nav>
</header>
<div class="md-container" data-md-component="container">
<nav aria-label="Tabs" class="md-tabs" data-md-component="tabs">
<div class="md-tabs__inner md-grid">
<ul class="md-tabs__list">
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../..">
        Documentation
      </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link md-tabs__link--active" href="../1_Overview/">
        Specification
      </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../../community/">
      Community
    </a>
</li>
</ul>
</div>
</nav>
<main class="md-main" data-md-component="main">
<div class="md-main__inner md-grid">
<div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Navigation" class="md-nav md-nav--primary md-nav--lifted" data-md-level="0">
<label class="md-nav__title" for="__drawer">
<a aria-label="ElectionGuard" class="md-nav__button md-logo" data-md-component="logo" href="../../.." title="ElectionGuard">
<img alt="logo" src="../../../images/electionguard-logo.png"/>
</a>
    ElectionGuard
  </label>
<div class="md-nav__source">
<a class="md-source" data-md-component="source" href="https://github.com/microsoft/electionguard/" title="Go to repository">
<div class="md-source__icon md-icon">
<svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"></path></svg>
</div>
<div class="md-source__repository">
    GitHub
  </div>
</a>
</div>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle" data-md-state="indeterminate" data-md-toggle="__nav_1" id="__nav_1" type="checkbox"/>
<label class="md-nav__link" for="__nav_1">
        Documentation
        <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-label="Documentation" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_1">
<span class="md-nav__icon md-icon"></span>
          Documentation
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle" data-md-state="indeterminate" data-md-toggle="__nav_1_1" id="__nav_1_1" type="checkbox"/>
<label class="md-nav__link" for="__nav_1_1">
        Overview
        <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-label="Overview" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_1_1">
<span class="md-nav__icon md-icon"></span>
          Overview
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../..">
        About
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../overview/Roadmap/">
        Roadmap
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../overview/Glossary/">
        Glossary
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../getting_started/">
        Getting Started
      </a>
</li>
<li class="md-nav__item md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle" data-md-state="indeterminate" data-md-toggle="__nav_1_3" id="__nav_1_3" type="checkbox"/>
<label class="md-nav__link" for="__nav_1_3">
        Concepts
        <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-label="Concepts" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_1_3">
<span class="md-nav__icon md-icon"></span>
          Concepts
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../concepts/Election_Manifest/">
        Manifest
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../concepts/Ballot_Encryption/">
        Ballot Encryption
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../concepts/Verifiable_Election/">
        Verifiable Election
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../concepts/Setting_up_an_election/">
        Setting up an Election
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../concepts/Ballot_Rescans_and_Recounts/">
        Rescanning Ballots and Recounts
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle" data-md-state="indeterminate" data-md-toggle="__nav_1_4" id="__nav_1_4" type="checkbox"/>
<label class="md-nav__link" for="__nav_1_4">
        Use Cases
        <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-label="Use Cases" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_1_4">
<span class="md-nav__icon md-icon"></span>
          Use Cases
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../use_cases/Precinct_Scan/">
        Precinct Scan
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle" data-md-state="indeterminate" data-md-toggle="__nav_1_5" id="__nav_1_5" type="checkbox"/>
<label class="md-nav__link" for="__nav_1_5">
        Develop
        <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-label="Develop" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_1_5">
<span class="md-nav__icon md-icon"></span>
          Develop
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../develop/Getting_Started/">
        Getting Started
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../develop/Architecture/">
        Architecture
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../develop/Data/">
        Data
      </a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--active md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" id="__nav_2" type="checkbox"/>
<label class="md-nav__link" for="__nav_2">
        Specification
        <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-label="Specification" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_2">
<span class="md-nav__icon md-icon"></span>
          Specification
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../1_Overview/">
        Overview
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../2_Structure/">
        Structure
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../3_Baseline_parameters/">
        Baseline Parameters
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../4_Key_generation/">
        Key Generation
      </a>
</li>
<li class="md-nav__item md-nav__item--active">
<input class="md-nav__toggle md-toggle" data-md-toggle="toc" id="__toc" type="checkbox"/>
<label class="md-nav__link md-nav__link--active" for="__toc">
          Ballot Encryption
          <span class="md-nav__icon md-icon"></span>
</label>
<a class="md-nav__link md-nav__link--active" href="./">
        Ballot Encryption
      </a>
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#outline-for-proofs-of-ballot-correctness">
    Outline for proofs of ballot correctness
  </a>
<nav aria-label="Outline for proofs of ballot correctness" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#nizk-proof-that-alpha-beta-is-an-encryption-of-zero-given-knowledge-of-encryption-nonce-r">
    NIZK Proof that \((\alpha, \beta)\) is an encryption of zero (given knowledge of encryption nonce \(R\))
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#nizk-proof-that-alphabeta-is-an-encryption-of-one-given-knowledge-of-encryption-nonce-r">
    NIZK Proof that \((\alpha,\beta)\) is an encryption of one (given knowledge of encryption nonce \(R\))
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#sketch-of-nizk-proof-that-alpha-beta-is-an-encryption-of-zero-or-one">
    Sketch of NIZK Proof that (\alpha, \beta) is an encryption of zero or one
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#details-for-proofs-of-ballot-correctness">
    Details for proofs of ballot correctness
  </a>
<nav aria-label="Details for proofs of ballot correctness" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#nizk-proof-that-alphabeta-is-an-encryption-of-zero-or-one-given-knowledge-of-encryption-nonce-r-for-which-is-an-encryption-of-zero">
    NIZK Proof that \((\alpha,\beta)\) is an encryption of zero or one (given knowledge of encryption nonce \(R\) for which \((α,β)\) is an encryption of zero)
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#nizk-proof-that-alphabeta-is-an-encryption-of-zero-or-one-given-knowledge-of-encryption-nonce-r-for-which-alphabeta-is-an-encryption-of-one">
    NIZK Proof that \((\alpha,\beta)\) is an encryption of zero or one (given knowledge of encryption nonce \(R\) for which \((\alpha,\beta)\) is an encryption of one)
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#proof-of-satisfying-the-selection-limit">
    Proof of satisfying the selection limit
  </a>
<nav aria-label="Proof of satisfying the selection limit" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#nizk-proof-that-alphabeta-is-an-encryption-of-l-given-knowledge-of-aggregate-encryption-nonce-r">
    NIZK Proof that \((\alpha,\beta)\) is an encryption of \(L\) (given knowledge of aggregate encryption nonce \(R\))
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#verification-codes">
    Verification Codes
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../6_Ballot_aggregation/">
        Ballot Aggregation
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../7_Verifiable_decryption/">
        Verifiable Decryption
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../8_The_election_record/">
        The Election Record
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../9_Verifier_construction/">
        Verifier Construction
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../10_Applicability/">
        Applicability to E2E Verifiability and RLA
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../11_Acknowledgements/">
        Acknowledgements
      </a>
</li>
<li class="md-nav__item md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle" data-md-state="indeterminate" data-md-toggle="__nav_2_12" id="__nav_2_12" type="checkbox"/>
<label class="md-nav__link" for="__nav_2_12">
        Other Versions
        <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-label="Other Versions" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_2_12">
<span class="md-nav__icon md-icon"></span>
          Other Versions
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle" data-md-state="indeterminate" data-md-toggle="__nav_2_12_1" id="__nav_2_12_1" type="checkbox"/>
<label class="md-nav__link" for="__nav_2_12_1">
        v0.95.0
        <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-label="v0.95.0" class="md-nav" data-md-level="3">
<label class="md-nav__title" for="__nav_2_12_1">
<span class="md-nav__icon md-icon"></span>
          v0.95.0
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../0.95.0/1_Overview/">
        Overview
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../0.95.0/2_Structure/">
        Structure
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../0.95.0/3_Baseline_parameters/">
        Baseline Parameters
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../0.95.0/4_Key_generation/">
        Key Generation
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../0.95.0/5_Ballot_encryption/">
        Ballot Encryption
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../0.95.0/6_Ballot_aggregation/">
        Ballot Aggregation
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../0.95.0/7_Verifiable_decryption/">
        Verifiable Decryption
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../0.95.0/8_The_election_record/">
        The Election Record
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../0.95.0/9_Verifier_construction/">
        Verifier Construction
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../0.95.0/10_Applicability/">
        Applicability to E2E Verifiability and RLA
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../0.95.0/11_Acknowledgements/">
        Acknowledgements
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="https://github.com/microsoft/electionguard/releases/tag/v0.85.0">
        v0.85.0
      </a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../community/">
        Community
      </a>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#outline-for-proofs-of-ballot-correctness">
    Outline for proofs of ballot correctness
  </a>
<nav aria-label="Outline for proofs of ballot correctness" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#nizk-proof-that-alpha-beta-is-an-encryption-of-zero-given-knowledge-of-encryption-nonce-r">
    NIZK Proof that \((\alpha, \beta)\) is an encryption of zero (given knowledge of encryption nonce \(R\))
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#nizk-proof-that-alphabeta-is-an-encryption-of-one-given-knowledge-of-encryption-nonce-r">
    NIZK Proof that \((\alpha,\beta)\) is an encryption of one (given knowledge of encryption nonce \(R\))
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#sketch-of-nizk-proof-that-alpha-beta-is-an-encryption-of-zero-or-one">
    Sketch of NIZK Proof that (\alpha, \beta) is an encryption of zero or one
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#details-for-proofs-of-ballot-correctness">
    Details for proofs of ballot correctness
  </a>
<nav aria-label="Details for proofs of ballot correctness" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#nizk-proof-that-alphabeta-is-an-encryption-of-zero-or-one-given-knowledge-of-encryption-nonce-r-for-which-is-an-encryption-of-zero">
    NIZK Proof that \((\alpha,\beta)\) is an encryption of zero or one (given knowledge of encryption nonce \(R\) for which \((α,β)\) is an encryption of zero)
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#nizk-proof-that-alphabeta-is-an-encryption-of-zero-or-one-given-knowledge-of-encryption-nonce-r-for-which-alphabeta-is-an-encryption-of-one">
    NIZK Proof that \((\alpha,\beta)\) is an encryption of zero or one (given knowledge of encryption nonce \(R\) for which \((\alpha,\beta)\) is an encryption of one)
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#proof-of-satisfying-the-selection-limit">
    Proof of satisfying the selection limit
  </a>
<nav aria-label="Proof of satisfying the selection limit" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#nizk-proof-that-alphabeta-is-an-encryption-of-l-given-knowledge-of-aggregate-encryption-nonce-r">
    NIZK Proof that \((\alpha,\beta)\) is an encryption of \(L\) (given knowledge of aggregate encryption nonce \(R\))
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#verification-codes">
    Verification Codes
  </a>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-content" data-md-component="content">
<article class="md-content__inner md-typeset">
<a class="md-content__button md-icon" href="https://github.com/microsoft/electionguard/edit/master/docs/spec/1.0.0/5_Ballot_encryption.md" title="Edit this page">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"></path></svg>
</a>
<h1 id="ballot-encryption">Ballot Encryption</h1>
<p>An ElectionGuard ballot is comprised entirely of encryptions of one (indicating selection made) and zero (indicating selection not made). To enable homomorphic addition (for tallying), these values are exponentiated during encryption. Specifically, to encrypt a ballot entry <span class="arithmatex">\((V)\)</span>, a random value <span class="arithmatex">\(R\)</span> is selected such that <span class="arithmatex">\(0 \le R \lt q\)</span> and the following computation is performed:</p>
<p>Zero (not selected) is encrypted as </p>
<div class="arithmatex">\[
(g^R \bmod p, K^R \bmod p)
\]</div>
<p>One (selected) is encrypted as </p>
<div class="arithmatex">\[
(g^R \bmod p, g \cdot K^R \bmod p)
\]</div>
<p>Note that if multiple encrypted votes <span class="arithmatex">\(\left(g^{R_i} \bmod p, g^{V_i} \cdot K^{R_i} \bmod p\right)\)</span> are formed, their component-wise product <span class="arithmatex">\(\left(g^{\sum_{i}V_i} \cdot K^{\sum_{i}R_i} \bmod p\right)\)</span> serves as an encryption of <span class="arithmatex">\(\sum_iV_i\)</span> – <em><strong>which is the tally of those votes</strong></em>.<sup id="fnref:19"><a class="footnote-ref" href="#fn:19">1</a></sup></p>
<p>A contest in an election consists of a set of options together with a selection limit that indicates the number of selections that are allowed to be made in that contest. In most elections, most contests have a selection limit of one. However, a larger selection limit (<em>e.g.</em>, select up to three) is not uncommon in some elections. Approval voting can be achieved by setting the selection limit to the total number of options in a contest. Ranked choice voting is not supported in this version of <em>ElectionGuard</em>, but it may be enabled in a future version.<sup id="fnref:20"><a class="footnote-ref" href="#fn:20">2</a></sup> Also, write-ins are assumed to be explicitly registered or allowed to be lumped into a single "write-ins" category for the purpose of verifiable tallying. Verifiable tallying of free-form write-ins may be best done with a MixNet<sup id="fnref:21"><a class="footnote-ref" href="#fn:21">3</a></sup> design.</p>
<p>A legitimate vote in a contest consists of a set of selections with cardinality not exceeding the selection limit of that contest. To accommodate legitimate undervotes, the internal representation of a contest is augmented with “placeholder” options equal in number to the selection limit. Placeholder options are selected as necessary to force the total number of selections made in a contest to be equal to the selection limit. When the selection limit is one, for example, the single placeholder option can be thought of as a “none of the above” option.</p>
<p>With larger selection limits, the number of placeholder options selected corresponds to the number of additional options that a voter could have selected in a contest.</p>
<div class="admonition info">
<p class="admonition-title">Info</p>
<p>For efficiency, the placeholder options could be eliminated in an approval vote. However, to simplify the construction of election verifiers, we presume that placeholder options are always present – even for approval votes.</p>
</div>
<p>Two things must now be proven about the encryption of each vote to ensure the integrity of a ballot.</p>
<ol>
<li>The encryption associated with each option is either an encryption of zero or an encryption of one.</li>
<li>The sum of all encrypted values in each contest is equal to the selection limit for that contest (usually one).</li>
</ol>
<p>The use of ElGamal encryption enables efficient zero-knowledge proofs of these requirements, and the Fiat-Shamir heuristic can be used to make these proofs non-interactive. Chaum- Pedersen proofs are used to demonstrate that an encryption is that of a specified value, and these are combined with the Cramer-Damgård-Schoenmakers technique to show that an encryption is that of one of a specified set of values – particularly that a value is an encryption of either zero or one. The encryptions of selections in a contest are homomorphically combined, and the result is shown to be an encryption of that contest’s selection limit – again using a Chaum-Pedersen proof.</p>
<div class="admonition info">
<p class="admonition-title">Info</p>
<p>Note that the decryption of the selection limit could be more efficiently demonstrated by just releasing the sum of the nonces used for each of the individual encryptions. But, again to simplify the construction of election verifiers, a Chaum-Pedersen proof is used here as well.</p>
</div>
<p>The “random” nonces used for the ElGamal encryption of the ballot nonces are derived from a single 256-bit master nonce <span class="arithmatex">\(R_B\)</span> for each ballot. For each contest listed in the ballot coding file, a contest nonce <span class="arithmatex">\(R_C\)</span> is derived from the master nonce <span class="arithmatex">\((R_B)\)</span> and the contest label <span class="arithmatex">\((L_C)\)</span> as </p>
<div class="arithmatex">\[
R_C= H(L_C,R_B)
\]</div>
<p>using the hash function SHA-256. For each option listed in the ballot coding file, the nonce used to encrypt that option is derived from the contest nonce <span class="arithmatex">\((R_C)\)</span> and the selection label for that option <span class="arithmatex">\((L_S)\)</span> as </p>
<div class="arithmatex">\[
R=H(L_S,R_C)
\]</div>
<p>A user of ElectionGuard may optionally provide an additional public key. If such a key is provided, ElectionGuard uses that key to encrypt each ballot’s master nonce <span class="arithmatex">\(R_B\)</span> and return this encryption together with the encrypted ballot.</p>
<p>Ballot nonces may be independent across different ballots, and only the nonces used to encrypt ballot selections need to be derived from the master nonce. The use of a single master nonce for each ballot allows the entire ballot encryption to be re-derived from the contents of a ballot and the master nonce. It also allows the encrypted ballot to be fully decrypted with the single master nonce.</p>
<h2 id="outline-for-proofs-of-ballot-correctness">Outline for proofs of ballot correctness</h2>
<p>To prove that an ElGamal encryption pair <span class="arithmatex">\((\alpha, \beta)\)</span> is an encryption of zero, the Chaum-Pedersen protocol proceeds as follows.</p>
<h3 id="nizk-proof-that-alpha-beta-is-an-encryption-of-zero-given-knowledge-of-encryption-nonce-r">NIZK Proof that <span class="arithmatex">\((\alpha, \beta)\)</span> is an encryption of zero (given knowledge of encryption nonce <span class="arithmatex">\(R\)</span>)</h3>
<p>The prover selects a random value <span class="arithmatex">\(u\)</span> in <span class="arithmatex">\(Z_q\)</span> and commits to the pair </p>
<div class="arithmatex">\[(g^u \bmod p, K^u \bmod p)
\]</div>
<p>A hash computation is then performed (using the Fiat-Shamir heuristic) to create a pseudo-random challenge value</p>
<div class="arithmatex">\[
c=H(\bar{Q},(\alpha,\beta),(a,b))
\]</div>
<p>and the prover responds with </p>
<div class="arithmatex">\[
v=(u + cR) \bmod q
\]</div>
<p>A verifier can now confirm the claim by checking that both </p>
<div class="arithmatex">\[
g^V \bmod p = a \cdot \alpha^C \bmod p
\]</div>
<p>and </p>
<div class="arithmatex">\[
K^V \bmod p = b \cdot \beta^{C} \mod p
\]</div>
<p>are true.</p>
<h3 id="nizk-proof-that-alphabeta-is-an-encryption-of-one-given-knowledge-of-encryption-nonce-r">NIZK Proof that <span class="arithmatex">\((\alpha,\beta)\)</span> is an encryption of one (given knowledge of encryption nonce <span class="arithmatex">\(R\)</span>)</h3>
<p>To prove that <span class="arithmatex">\((\alpha, \beta)\)</span> is an encryption of one, <span class="arithmatex">\(\frac{\beta}{g} \bmod p\)</span> is substituted for <span class="arithmatex">\(\beta\)</span> in the above. The verifier can be relieved of the need to perform a modular division by computing <span class="arithmatex">\(\beta \bar{g} \bmod p\)</span> rather than <span class="arithmatex">\(\beta \bmod p\)</span>. As an alternative, the verifier can confirm that </p>
<div class="arithmatex">\[
g^c \cdot K^v \bmod p = b \cdot \left(\frac{\beta}{g}\right)^c
\]</div>
<p>instead of</p>
<div class="arithmatex">\[
K^v \bmod p = b \cdot \left(\frac{\beta}{g}\right)^c \bmod p
\]</div>
<p>As with many zero-knowledge protocols, if the prover knows a challenge value prior to making its commitment, it can create a false proof.  For example, if a challenge <span class="arithmatex">\(c\)</span> is known to be forthcoming, a prover can generate a random <span class="arithmatex">\(v\)</span> in <span class="arithmatex">\(Z_q\)</span> and commit to </p>
<div class="arithmatex">\[
(a,b)=\left(\frac{g^v}{α^c} \bmod p,\frac{K^v}{\beta^c} \bmod p\right)=\left(g^v \alpha^{(q-c)} \bmod p,K^v \beta^{(q-c)} \bmod p\right)
\]</div>
<p>This selection will satisfy the required checks for (α,β) to appear as an encryption of zero regardless of the values of (α,β).  Similarly, setting</p>
<div class="arithmatex">\[
(a,b)=\left(\frac{g^v}{α^c} \bmod p,\frac{K^v g^c}{β^c} \bmod p\right)=\left(g^v α^{(q-c)} \bmod p,K^v \beta^{(q-c)} \bmod p\right)
\]</div>
<p>will satisfy the required checks for <span class="arithmatex">\((\alpha,\beta)\)</span> to appear as an encryption of one regardless of the values of (α,β).  This quirk is what enables the Cramer-Damgård-Schoenmakers technique to prove a disjunction of two predicates.</p>
<h3 id="sketch-of-nizk-proof-that-alpha-beta-is-an-encryption-of-zero-or-one">Sketch of NIZK Proof that (\alpha, \beta) is an encryption of zero or one</h3>
<p>After the prover makes commitments <span class="arithmatex">\((a_0,b_0 )\)</span> and <span class="arithmatex">\((a_1,b_1 )\)</span> to the respective assertions that <span class="arithmatex">\((α,β)\)</span> is an encryption of zero and <span class="arithmatex">\((α,β)\)</span> is an encryption of one, a single challenge value <span class="arithmatex">\(c\)</span> is selected by hashing all commitments and baseline parameters.  The prover must then provide challenge values <span class="arithmatex">\(c_0\)</span> and <span class="arithmatex">\(c_1\)</span> such that <span class="arithmatex">\(c=c_0+c_1 \bmod q\)</span>.  Since the prover has complete freedom to choose one of <span class="arithmatex">\(c_0\)</span> and <span class="arithmatex">\(c_1\)</span>, the prover can fix one value in advance – either <span class="arithmatex">\(c_0\)</span> if <span class="arithmatex">\((α,β)\)</span> is actually an encryption of one or <span class="arithmatex">\(c_1\)</span> if <span class="arithmatex">\((α,β)\)</span> is actually an encryption of zero.  In response to the resulting challenge <span class="arithmatex">\(c\)</span>, the prover uses this freedom to answer its faux claim with its chosen challenge value and then uses the remaining challenge value (as forced by the constraint that <span class="arithmatex">\(c=(c_0+c_1 ) \bmod q)\)</span> to demonstrate the truth of the other claim.  An observer can see that one of the two claims must be true but cannot tell which.</p>
<h2 id="details-for-proofs-of-ballot-correctness">Details for proofs of ballot correctness</h2>
<p>The full protocol proceeds as follows – fully divided into the two cases.
To encrypt an “unselected” option on a ballot, a random nonce R is selected uniformly Z_q and an encryption of zero is formed as</p>
<div class="arithmatex">\[
(α,β)=(g^R \bmod p,K^R  \bmod p)
\]</div>
<h3 id="nizk-proof-that-alphabeta-is-an-encryption-of-zero-or-one-given-knowledge-of-encryption-nonce-r-for-which-is-an-encryption-of-zero">NIZK Proof that <span class="arithmatex">\((\alpha,\beta)\)</span> is an encryption of zero or one (given knowledge of encryption nonce <span class="arithmatex">\(R\)</span> for which <span class="arithmatex">\((α,β)\)</span> is an encryption of zero)</h3>
<p>To create the proof that <span class="arithmatex">\((α,β)\)</span> is an encryption of a zero or a one, randomly select <span class="arithmatex">\(c_1\)</span>, <span class="arithmatex">\(v_1\)</span>, and <span class="arithmatex">\(u_0\)</span> from <span class="arithmatex">\(Z_q\)</span> and form the commitments </p>
<div class="arithmatex">\[
(a_0,b_0 )=(g^{u_0} \bmod p,K^{u_0} \bmod p)
\]</div>
<p>and</p>
<div class="arithmatex">\[
(a_1,b_1 )=\left(\frac{g^{v_1}}{\alpha^{c_1}} \bmod p,\frac{K^{v_1} g^{c_1}}{\beta^{c_1}}  \bmod p\right)=\left(g^{v_1 } \alpha^{(q-c_1)}  \bmod p,K^{v_1} g^{c_1} \beta^{(q-c_1)} \bmod p\right)
\]</div>
<p>A challenge value <span class="arithmatex">\(c\)</span> is formed by hashing the extended base hash <span class="arithmatex">\(\bar{Q}\)</span> together with <span class="arithmatex">\((\alpha,\beta)\)</span>, <span class="arithmatex">\((a_0,b_0 )\)</span>, and <span class="arithmatex">\((a_1,b_1 )\)</span> to form a challenge value </p>
<div class="arithmatex">\[
c=H\left(Q ̅,(α,β),(a_0,b_0 ),(a_1,b_1 )\right)
\]</div>
<p>The proof is completed by forming <span class="arithmatex">\(c_0=(c-c_1 )  \bmod q\)</span> and <span class="arithmatex">\(v_0=(u_0+c_0 \cdot R)  \bmod q\)</span> and answering the challenge by returning <span class="arithmatex">\(c_0\)</span>, <span class="arithmatex">\(c_1\)</span>, <span class="arithmatex">\(v_0\)</span>, and <span class="arithmatex">\(v_1\)</span>.</p>
<p>To encrypt a “selected” option on a ballot, a random nonce <span class="arithmatex">\(R\)</span> is selected uniformly from <span class="arithmatex">\(Z_q\)</span> and an encryption of one is formed as <span class="arithmatex">\((\alpha,\beta)=(g^r  \bmod p, g \cdot K^r  \bmod p)\)</span>.</p>
<h3 id="nizk-proof-that-alphabeta-is-an-encryption-of-zero-or-one-given-knowledge-of-encryption-nonce-r-for-which-alphabeta-is-an-encryption-of-one">NIZK Proof that <span class="arithmatex">\((\alpha,\beta)\)</span> is an encryption of zero or one (given knowledge of encryption nonce <span class="arithmatex">\(R\)</span> for which <span class="arithmatex">\((\alpha,\beta)\)</span> is an encryption of one)</h3>
<p>To create the proof that <span class="arithmatex">\((\alpha,\beta)\)</span> is an encryption of a zero or a one, randomly select <span class="arithmatex">\(c_0\)</span>, <span class="arithmatex">\(v_0\)</span>, and <span class="arithmatex">\(u_1\)</span> from <span class="arithmatex">\(Z_q\)</span> and form the commitments</p>
<div class="arithmatex">\[
(a_0,b_0) = \left( \frac{g^{v_0}}{\alpha^{c_0}} \bmod p,\frac{K^{v_0}}{\beta^{c_0 }} \bmod p\right) = \left(g^{v_0} α^{(q-c_0)}  \bmod p,K^{v_0} \beta^{(q-c_0 )} \bmod p\right)
\]</div>
<p>and</p>
<div class="arithmatex">\[
(a_1,b_1 )=(g^{u_1} \bmod p,K^{u_1}  \bmod p)
\]</div>
<p>A challenge value <span class="arithmatex">\(c\)</span> is formed by hashing the extended base hash <span class="arithmatex">\(\bar{Q}\)</span> together with <span class="arithmatex">\((\alpha,\beta)\)</span>, <span class="arithmatex">\((a_0,b_0 )\)</span>, and <span class="arithmatex">\((a_1,b_1 )\)</span> to form a challenge value </p>
<div class="arithmatex">\[
c=H\left(\bar{Q},(\alpha,\beta),(a_0,b_0 ),(a_1,b_1 )\right)
\]</div>
<p>The proof is completed by forming </p>
<div class="arithmatex">\[
c_1=(c-c_0 )  \bmod q
\]</div>
<p>and </p>
<div class="arithmatex">\[
v_1=(u_1+c_1\cdot R)  \bmod q
\]</div>
<p>and answering the challenge by returning <span class="arithmatex">\(c_0\)</span>, <span class="arithmatex">\(c_1\)</span>, <span class="arithmatex">\(v_0\)</span>, and <span class="arithmatex">\(v_1\)</span>.</p>
<p>In either of the two above cases, what is published in the election record is the encryption <span class="arithmatex">\((\alpha,\beta)\)</span> together with the commitments <span class="arithmatex">\((a_0,b_0 )\)</span> and <span class="arithmatex">\((a_1,b_1 )\)</span> which are all hashed together with the election’s extended base hash to form the challenge value c which is published together with values <span class="arithmatex">\(c_0\)</span>, <span class="arithmatex">\(c_1\)</span>, <span class="arithmatex">\(v_0\)</span>, and <span class="arithmatex">\(v_1\)</span>.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>An election verifier must confirm the following for each possible selection on a ballot:</p>
<p>(A) The given values <span class="arithmatex">\(\alpha\)</span>, <span class="arithmatex">\(\beta\)</span>, <span class="arithmatex">\(a_0\)</span>, <span class="arithmatex">\(b_0\)</span>, <span class="arithmatex">\(a_1\)</span>, and <span class="arithmatex">\(b_1\)</span> are all in the set <span class="arithmatex">\(Z_p^r\)</span>.  (A value <span class="arithmatex">\(x\)</span> is in <span class="arithmatex">\(Z_p^r\)</span> if and only if <span class="arithmatex">\(x\)</span> is an integer such that <span class="arithmatex">\(0 \le x \lt p\)</span> and <span class="arithmatex">\(x^q  \bmod p=1\)</span> is satisfied.)</p>
<p>(B) The challenge <span class="arithmatex">\(c\)</span> is correctly computed as</p>
<div class="arithmatex">\[
c=H\left(\bar{Q},(\alpha,\beta),(a_0,b_0 ),(a_1,b_1 )\right)
\]</div>
<p>(C) The given values c_0, c_1, v_0, and v_1 are each in the set Z_q.  (A value <span class="arithmatex">\(x\)</span> is in <span class="arithmatex">\(Z_q\)</span> if and only if <span class="arithmatex">\(x\)</span> is an integer such that <span class="arithmatex">\(0 \le x \lt q\)</span>).</p>
<p>(D) The equation </p>
<div class="arithmatex">\[
c=(c_0+c_1 ) \bmod q
\]</div>
<p>is satisfied.</p>
<p>(E) The equation </p>
<div class="arithmatex">\[
g^{v_0}  \bmod p=a_0 α^{c_0}  \bmod p
\]</div>
<p>is satisfied.</p>
<p>(F) The equation </p>
<div class="arithmatex">\[
g^{v_1} \bmod p=a_1 \alpha^{c_1}  \bmod p 
\]</div>
<p>is satisfied.</p>
<p>(G) The equation </p>
<div class="arithmatex">\[
K^{v_0} \bmod p=b_0 \beta^{c_0}  \bmod p
\]</div>
<p>is satisfied.</p>
<p>(H) The equation</p>
<div class="arithmatex">\[
g^{c_1} K^{v_1}  \bmod p=b_1 \beta^{c_1}  \bmod p
\]</div>
<p>is satisfied.</p>
</div>
<h2 id="proof-of-satisfying-the-selection-limit">Proof of satisfying the selection limit</h2>
<p>The final step in proving that a ballot is well-formed is demonstrating that the selection limits for each contest have not been exceeded.  This is accomplished by homomorphically combining all of the <span class="arithmatex">\((\alpha_i,\beta_i )\)</span> values for a contest by forming the aggregate contest encryption </p>
<div class="arithmatex">\[
(\alpha,\beta)=(\prod_i \alpha_i  \bmod p,\prod_i \beta_i  \bmod p)
\]</div>
<p>and proving that <span class="arithmatex">\((\alpha,\beta)\)</span> is an encryption of the total number of votes allowed for that contest (usually one).  The simplest way to complete this proof is to combine all of the random nonces <span class="arithmatex">\(R_i\)</span> that were used to form each</p>
<div class="arithmatex">\[
(\alpha_i,\beta_i )=\left(g^{R_i} \bmod p,K^{R_i}  \bmod p\right)
\]</div>
<p>or</p>
<div class="arithmatex">\[
(\alpha_i,\beta_i )=\left(g^{R_i}  \bmod p,g \cdot K^{R_i}  \bmod p\right)
\]</div>
<p>depending on whether the value encrypted is zero or one.  The aggregate nonce</p>
<div class="arithmatex">\[
R=\sum_i R_i  \bmod q
\]</div>
<p>matches the aggregate contest encryption as </p>
<div class="arithmatex">\[
(\alpha,\beta)=(\prod_i\alpha_i  \bmod p,\prod_i \beta_i  \bmod p)= (g^R \bmod p,g^L K^R \bmod p)
\]</div>
<p>where <span class="arithmatex">\(L\)</span> is the selection limit for the contest.  (Recall that <span class="arithmatex">\(L\)</span> extra “placeholder” positions will be added to each contest and set to one as necessary to ensure that exactly <span class="arithmatex">\(L\)</span> selections are made for the contest.)</p>
<h3 id="nizk-proof-that-alphabeta-is-an-encryption-of-l-given-knowledge-of-aggregate-encryption-nonce-r">NIZK Proof that <span class="arithmatex">\((\alpha,\beta)\)</span> is an encryption of <span class="arithmatex">\(L\)</span> (given knowledge of aggregate encryption nonce <span class="arithmatex">\(R\)</span>)</h3>
<p>An additional Chaum-Pedersen proof of <span class="arithmatex">\((\alpha,\beta)\)</span> being an encryption of <span class="arithmatex">\(L\)</span> is performed by selecting a random <span class="arithmatex">\(U\)</span> in <span class="arithmatex">\(Z_q\)</span>, publishing</p>
<div class="arithmatex">\[
(a,b)=(g^U  \bmod p,K^U \bmod p)
\]</div>
<p>then hashing these values together with the election’s extended base hash <span class="arithmatex">\(\bar{Q}\)</span> to form a pseudo-random challenge</p>
<div class="arithmatex">\[
C=H\left(\bar{Q},(\alpha,\beta),(a,b)\right)
\]</div>
<p>and responding by publishing <sup id="fnref:22"><a class="footnote-ref" href="#fn:22">4</a></sup></p>
<div class="arithmatex">\[
V=(U+CR) \bmod q
\]</div>
<p>Note that all of the above proofs can be performed directly by the entity performing the public key encryption of a ballot without access to the decryption key(s).  All that is required is the nonces <span class="arithmatex">\(R_i\)</span> used for the individual selection encryptions.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>An election verifier must confirm the following for each contest on the ballot:</p>
<p>(A) The number of <strong>placeholder</strong> positions matches the contest’s selection limit <span class="arithmatex">\(L\)</span></p>
<p>(B) The contest total <span class="arithmatex">\((A,B)\)</span> satisfies</p>
<div class="arithmatex">\[
A=\prod_i \alpha_i  \bmod p
\]</div>
<p>and</p>
<div class="arithmatex">\[
B=\prod_i \beta_i  \bmod p
\]</div>
<p>where the <span class="arithmatex">\((\alpha_i,\beta_i )\)</span> represent all possible selections (including placeholder selections) for the contest.</p>
<p>(C) The given value <span class="arithmatex">\(V\)</span> is in <span class="arithmatex">\(Z_q\)</span>.</p>
<p>(D) The given values <span class="arithmatex">\(a\)</span> and <span class="arithmatex">\(b\)</span> are each in <span class="arithmatex">\(Z_p^r\)</span>.</p>
<p>(E) The challenge value <span class="arithmatex">\(C\)</span> is correctly computed as</p>
<div class="arithmatex">\[
C=H\left(\bar{Q},(A,B),(a,b)\right)
\]</div>
<p>(F) The equation</p>
<div class="arithmatex">\[
g^V  \bmod p=(aA^C )  \bmod p
\]</div>
<p>is satisfied.</p>
<p>(G) The equation</p>
<div class="arithmatex">\[
(g^{LC} K^V) \bmod p=(bB^C ) \bmod p
\]</div>
<p>is satisfied.</p>
</div>
<h2 id="verification-codes">Verification Codes</h2>
<p>Upon completion of the encryption of each ballot, a verification code is prepared for each voter.  The code is a running hash that begins with the extended base hash code <span class="arithmatex">\(\bar{Q}\)</span> and includes an identifier for the voting device, the location of the voting device, the date and time that the ballot was encrypted, and, of course, the encryption of the ballot itself.  The hash <span class="arithmatex">\((H)\)</span> used for this purpose is SHA-256.  </p>
<p>The tracking code is formed as follows.  </p>
<div class="arithmatex">\[
H_0=H(\bar{Q})
\]</div>
<p>where  <span class="arithmatex">\(\bar{Q}\)</span> is the extended base hash code of the election.  For ballot with index <span class="arithmatex">\(i&gt;0\)</span>, </p>
<div class="arithmatex">\[
H_i=H(H_{i-1},D,T,B_i)
\]</div>
<p>where <span class="arithmatex">\(D\)</span> consists of the voting device information described above, <span class="arithmatex">\(T\)</span> is the date and time of ballot encryption, and <span class="arithmatex">\(B_i\)</span> is an ordered list of the individual encryptions on the ballot – with the ordering as specified by the ballot coding file.  At the conclusion of a voting period (this may be the end of a day in a multi-day election), the hash chain is closed by computing  </p>
<div class="arithmatex">\[
\bar{H}=H(H_l, \text{“CLOSE"})
\]</div>
<p>where <span class="arithmatex">\(H_l\)</span> is the final verification code produced by that device during that voting period.  The close of the hash chain can be computed either by the voting device or subsequently by election administrators, and it is published as part of the election record.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>An election verifier must confirm that each of the values in the running hash is correctly computed.  Specifically, an election verifier must confirm each of the following.</p>
<p>(A) The equation <span class="arithmatex">\(H_0=H(\overline{Q},\text{“OPEN"})\)</span> is satisfied.</p>
<p>(B)     For each ballot <span class="arithmatex">\(B_i\)</span>,</p>
<div class="arithmatex">\[
H_i=H\left(H_{i-1},D,T,B_i\right)
\]</div>
<p>is satisfied.</p>
<p>(C) The closing hash </p>
<div class="arithmatex">\[
\bar{H}=H(H_l,\text{“CLOSE"})
\]</div>
<p>is correctly computed from the final tracking code <span class="arithmatex">\(H_l\)</span></p>
</div>
<p>Once in possession of a tracking code (<strong><em>and never before</em></strong>), a voter is afforded an option to either cast the associated ballot or spoil it and restart the ballot preparation process.  The precise mechanism for voters to make these selections may vary depending upon the instantiation, but this choice would ordinarily be made immediately after a voter is presented with the tracking code, and the status of the ballot would be undetermined until the decision is made.  It is possible, for instance, for a voter to make the decision directly on the voting device, or a voter may instead be afforded an option to deposit the ballot in a receptacle or to take it to a poll worker to be spoiled.  For vote-by-mail scenarios, a voter can be sent (hashes of) two complete sets of encryptions for each selectable option and can effect a ballot challenge implicitly by choosing which encryptions to return.</p>
<div class="footnote">
<hr/>
<ol>
<li id="fn:19">
<p>The initial decryption actually forms the value <span class="arithmatex">\(g^\sum_i V_i \bmod p\)</span>.  However, since <span class="arithmatex">\(\sum_i V_i\)</span> is a relatively small value, it can be effectively computed from <span class="arithmatex">\(g^\sum_i V_i \bmod p\)</span> by means of an exhaustive search or similar methods. <a class="footnote-backref" href="#fnref:19" title="Jump back to footnote 1 in the text">↩</a></p>
</li>
<li id="fn:20">
<p>Benaloh J., Moran. T, Naish L., Ramchen K., and Teague V.  Shuffle-Sum:  Coercion-Resistant Verifiable Tallying for STV Voting  (2009) in Transactions of Information Forensics and Security <a class="footnote-backref" href="#fnref:20" title="Jump back to footnote 2 in the text">↩</a></p>
</li>
<li id="fn:21">
<p>Chaum D.  Untraceable Electronic Mail, Return Addresses, and Digital Pseudonyms (1981) Communications of the ACM <a class="footnote-backref" href="#fnref:21" title="Jump back to footnote 3 in the text">↩</a></p>
</li>
<li id="fn:22">
<p>One could simply release the aggregate nonce <span class="arithmatex">\(R=\prod_i R_i  \bmod q\)</span> to complete this proof.  However, since Chaum-Pedersen proofs are being performed elsewhere, it is simpler for a verifier to just repeat the same steps. <a class="footnote-backref" href="#fnref:22" title="Jump back to footnote 4 in the text">↩</a></p>
</li>
</ol>
</div>
</article>
</div>
</div>
</main>
<footer class="md-footer">
<div class="md-footer-nav">
<nav aria-label="Footer" class="md-footer-nav__inner md-grid">
<a class="md-footer-nav__link md-footer-nav__link--prev" href="../4_Key_generation/" rel="prev" title="Key Generation">
<div class="md-footer-nav__button md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"></path></svg>
</div>
<div class="md-footer-nav__title">
<div class="md-ellipsis">
<span class="md-footer-nav__direction">
                  Previous
                </span>
                Key Generation
              </div>
</div>
</a>
<a class="md-footer-nav__link md-footer-nav__link--next" href="../6_Ballot_aggregation/" rel="next" title="Ballot Aggregation">
<div class="md-footer-nav__title">
<div class="md-ellipsis">
<span class="md-footer-nav__direction">
                  Next
                </span>
                Ballot Aggregation
              </div>
</div>
<div class="md-footer-nav__button md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"></path></svg>
</div>
</a>
</nav>
</div>
<div class="md-footer-meta md-typeset">
<div class="md-footer-meta__inner md-grid">
<div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" rel="noopener" target="_blank">
          Material for MkDocs
        </a> and <a href="https://icons8.com/" rel="noopener" target="_blank">
          Icons8
        </a>
</div>
<div class="md-footer-copyright" style="display: flex; align-items:center;">
<ul style="list-style: none;">
<li><a href="https://privacy.microsoft.com">Privacy</a></li>
<li><a href="">Terms of Service</a></li>
</ul>
</div>
</div>
</div>
</footer>
</div>
<div class="md-dialog" data-md-component="dialog">
<div class="md-dialog__inner md-typeset"></div>
</div>
<script id="__config" type="application/json">{"base": "../../..", "features": ["navigation.expand", "navigation.instant", "navigation.tabs"], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "../../../assets/javascripts/workers/search.709b4209.min.js", "version": null}</script>
<script src="../../../assets/javascripts/bundle.2b46852b.min.js"></script>
<script src="../../../javascripts/config.js"></script>
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
</body>
</html>